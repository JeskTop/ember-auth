// Generated by EmberScript 0.0.7
var get$=Ember.get;Em.onLoad("Ember.Application",function(e){return e.initializer({name:"ember-auth",initialize:function(e,t){return t.register("auth:main",get$(t,"Auth")||get$(Em,"Auth")),t.inject("route","auth","auth:main"),t.inject("controller","auth","auth:main"),t.inject("view","auth","auth:main")}}),e.initializer({name:"ember-auth-load",after:"ember-auth",initialize:function(e,t){return e.lookup("auth:main")}})});var get$=Ember.get,set$=Ember.set;set$(Em,"Auth",Ember.Object.extend({init:function(){return this._initializeAdapters(),this._initializeModules()},_handlers:{signInSuccess:[],signInError:[],signOutSuccess:[],signOutError:[],sendSuccess:[],sendError:[]},module:{},_initializeAdapters:function(){var e,t,n,r,i,s,o,u;for(var a=["request","response","strategy","session"],f=0,l=a.length;f<l;++f)u=a[f],o="The `"+u+"` config should be a string",n=this.get(u),Em.assert(o,typeof n=="string"),i="auth"+get$(Em,"String").classify(u),r=""+i+":"+n,e=get$(this,"container").lookupFactory(r),t=get$(Em,"String").classify(i),s=""+get$(Em,"String").classify(n)+t,o="The requested `"+n+"` "+u+"Adapter cannot be found. Either name it (YourApp)."+s+", or register it in the container under `"+r+"`.",Em.assert(o,e),o="The requested `"+n+"` "+u+"Adapter must extend from Ember.Auth."+t,Em.assert(o,get$(Em,"Auth")[t].detect(e)),this.set("_"+u,e.create({auth:this}));return null},_initializeModules:function(){var e,t,n,r,i;for(var s=0,o=get$(this,"modules").length;s<o;++s)r=get$(this,"modules")[s],e="authModule:"+r,t=""+get$(Em,"String").classify(r)+"AuthModule",n=get$(this,"container").lookupFactory(e),i="The requested `"+r+"` module cannot be found. Either name it (YourApp)."+t+", or register it in the container under `"+e+"`.",Em.assert(i,n),this.set("module."+r,n.create({auth:this}));return null},signIn:function(e,t){var n;return typeof t=="undefined"?(t=e,e=get$(this,"_request").resolveUrl(get$(this,"signInEndPoint"))):e=get$(this,"_request").resolveUrl(e),t||(t={}),new(get$(get$(Em,"RSVP"),"Promise"))((n=this,function(r,i){var s,o;return get$(n,"_request").signIn(e,get$(n,"_strategy").serialize(t)).then((s=n,function(e){var t,n,o;t=get$(s,"_response").canonicalize(e),o=[],o.push(get$(s,"_strategy").deserialize(t)),o.push(get$(s,"_session").start(t));for(var u=0,a=get$(get$(s,"_handlers"),"signInSuccess").length;u<a;++u)n=get$(get$(s,"_handlers"),"signInSuccess")[u],o.push(n(t));return get$(Em,"RSVP").all(o).then(function(){return r(t)}).fail(function(){return i(t)})})).fail((o=n,function(e){var t,n,r;t=get$(o,"_response").canonicalize(e),r=[],r.push(get$(o,"_strategy").deserialize(t)),r.push(get$(o,"_session").end(t));for(var s=0,u=get$(get$(o,"_handlers"),"signInError").length;s<u;++s)n=get$(get$(o,"_handlers"),"signInError")[s],r.push(n(t));return get$(Em,"RSVP").all(r).then(function(){return i(t)}).fail(function(){return i(t)})}))}))},signOut:function(e,t){var n;return typeof t=="undefined"?(t=e,e=get$(this,"_request").resolveUrl(get$(this,"signOutEndPoint"))):e=get$(this,"_request").resolveUrl(e),t||(t={}),new(get$(get$(Em,"RSVP"),"Promise"))((n=this,function(r,i){var s,o;return get$(n,"_request").signOut(e,get$(n,"_strategy").serialize(t)).then((s=n,function(e){var t,n,o;t=get$(s,"_response").canonicalize(e),o=[],o.push(get$(s,"_strategy").deserialize(t)),o.push(get$(s,"_session").end(t));for(var u=0,a=get$(get$(s,"_handlers"),"signOutSuccess").length;u<a;++u)n=get$(get$(s,"_handlers"),"signOutSuccess")[u],o.push(n(t));return get$(Em,"RSVP").all(o).then(function(){return r(t)}).fail(function(){return i(t)})})).fail((o=n,function(e){var t,n,r;t=get$(o,"_response").canonicalize(e),r=[];for(var s=0,u=get$(get$(o,"_handlers"),"signOutError").length;s<u;++s)n=get$(get$(o,"_handlers"),"signOutError")[s],r.push(n(t));return get$(Em,"RSVP").all(r).then(function(){return i(t)}).fail(function(){return i(t)})}))}))},send:function(e,t){var n;return typeof t=="undefined"?(t=e,e=get$(this,"_request").resolveUrl("")):e=get$(this,"_request").resolveUrl(e),t||(t={}),new(get$(get$(Em,"RSVP"),"Promise"))((n=this,function(r,i){var s,o;return get$(n,"_request").send(e,get$(n,"_strategy").serialize(t)).then((s=n,function(e){var t,n;n=[];for(var o=0,u=get$(get$(s,"_handlers"),"sendSuccess").length;o<u;++o)t=get$(get$(s,"_handlers"),"sendSuccess")[o],n.push(t(e));return get$(Em,"RSVP").all(n).then(function(){return r(data)}).fail(function(){return i(data)})})).fail((o=n,function(e){var t,n;n=[];for(var r=0,s=get$(get$(o,"_handlers"),"sendError").length;r<s;++r)t=get$(get$(o,"_handlers"),"sendError")[r],n.push(t(e));return get$(Em,"RSVP").all(n).then(function(){return i(data)}).fail(function(){return i(data)})}))}))},createSession:function(e){var t;return new(get$(get$(Em,"RSVP"),"Promise"))((t=this,function(n,r){var i,s;typeof e=="string"&&(e=get$(t,"_response").canonicalize(e)),s=[],s.push(get$(t,"_strategy").deserialize(e)),s.push(get$(t,"_session").start(e));for(var o=0,u=get$(get$(t,"_handlers"),"signInSuccess").length;o<u;++o)i=get$(get$(t,"_handlers"),"signInSuccess")[o],s.push(i(e));return get$(Em,"RSVP").all(s).then(function(){return n(e)}).fail(function(){return r(e)})}))},destroySession:function(e){var t;return new(get$(get$(Em,"RSVP"),"Promise"))((t=this,function(n,r){var i,s;typeof e=="string"&&(e=get$(t,"_response").canonicalize(e)),s=[],s.push(get$(t,"_strategy").deserialize(e)),s.push(get$(t,"_session").end(e));for(var o=0,u=get$(get$(t,"_handlers"),"signOutSuccess").length;o<u;++o)i=get$(get$(t,"_handlers"),"signOutSuccess")[o],s.push(i(e));return get$(Em,"RSVP").all(s).then(function(){return n(e)}).fail(function(){return r(e)})}))},addHandler:function(e,t){var n;return n="Handler type unrecognized; you passed in `"+e+"`",Em.assert(n,null!=get$(this,"_handlers")[e]),n="Handler must be a function",Em.assert(n,typeof t=="function"),get$(this,"_handlers")[e].pushObject(t)},removeHandler:function(e,t){var n;return n="Handler type unrecognized; you passed in `"+e+"`",Em.assert(n,null!=get$(this,"_handlers")[e]),n="Handler must be a function or omitted for removing all handlers",Em.assert(n,typeof t=="function"||typeof t=="undefined"),null!=t?get$(this,"_handlers")[e].removeObject(t):get$(this,"_handlers")[e]=[]}})),void function(){var e,t=Ember.get,n=Ember.set;e=function(e){return function(){throw new(t(Em,"Error"))("Your request adapter "+this.toString()+" must implement the required method `"+e+"`")}},n(t(Em,"Auth"),"AuthRequest",Ember.Object.extend({signIn:e("signIn"),signOut:e("signOut"),send:e("send"),resolveUrl:function(e){var n;return n=t(t(this,"auth"),"baseUrl"),n&&n[t(n,"length")-1]==="/"&&(n=n.substr(0,t(n,"length")-1)),(null!=e?e[0]:void 0)==="/"&&(e=e.substr(1,t(e,"length"))),[n,e].join("/")}}))}.call(this),void function(){var e,t=Ember.get,n=Ember.set;e=function(e){return function(){throw new(t(Em,"Error"))("Your response adapter "+this.toString()+" must implement the required method `"+e+"`")}},n(t(Em,"Auth"),"AuthResponse",Ember.Object.extend({canonicalize:e("canonicalize")}))}.call(this),void function(){var e,t=Ember.get,n=Ember.set;e=function(e){return function(){throw new(t(Em,"Error"))("Your strategy adapter "+this.toString()+" must implement the required method `"+e+"`")}},n(t(Em,"Auth"),"AuthStrategy",Ember.Object.extend({serialize:e("serialize"),deserialize:e("deserialize")}))}.call(this),void function(){var e,t=Ember.get,n=Ember.set;e=function(e){return function(){throw new(t(Em,"Error"))("Your session adapter "+this.toString()+" must implement the required method `"+e+"`")}},n(t(Em,"Auth"),"AuthSession",Ember.Object.extend({init:function(){return t(this,"auth").reopen({signedIn:t(Em,"computed").alias("_session.signedIn"),userId:t(Em,"computed").alias("_session.userId"),startTime:t(Em,"computed").alias("_session.startTime"),endTime:t(Em,"computed").alias("_session.endTime")}),t(this,"auth").addHandler("signInSuccess",t(this,"start")),t(this,"auth").addHandler("signOutSuccess",t(this,"end"))},signedIn:!1,userId:null,startTime:null,endTime:null,start:function(){return n(this,"signedIn",!0),n(this,"startTime",new Date),n(this,"endTime",null)},end:function(){return n(this,"signedIn",!1),n(this,"userId",null),n(this,"startTime",null),n(this,"endTime",new Date)},retrieve:e("retrieve"),store:e("store"),remove:e("remove")}))}.call(this);var get$=Ember.get;get$(Em,"Auth").reopen({request:"jquery",response:"json",strategy:"token",session:"cookie",modules:[],signInEndPoint:null,signOutEndPoint:null,baseUrl:null});